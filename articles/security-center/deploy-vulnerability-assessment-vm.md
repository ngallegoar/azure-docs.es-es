---
title: Solución de evaluación de vulnerabilidades integrada en Security Center para Azure y máquinas híbridas
description: Instale una solución de evaluación de vulnerabilidades en máquinas de Azure para obtener recomendaciones de Azure Security Center que le ayuden a proteger Azure y las máquinas virtuales.
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 10/13/2020
ms.author: memildin
ms.openlocfilehash: 2a489dea6a4b79f539f9b373490ca0afaedac0e1
ms.sourcegitcommit: 693df7d78dfd5393a28bf1508e3e7487e2132293
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/28/2020
ms.locfileid: "92901572"
---
# <a name="azure-defenders-integrated-vulnerability-assessment-solution-for-azure-and-hybrid-machines"></a>Solución de evaluación de vulnerabilidades integrada en Azure Defender para Azure y máquinas híbridas

Un componente fundamental de cada programa de seguridad y riesgo cibernético es la identificación y el análisis de las vulnerabilidades. 

Security Center comprueba regularmente las máquinas conectadas para asegurarse de que están ejecutando herramientas de evaluación de vulnerabilidades.

Cuando se detecta una máquina que no tiene implementada una solución de evaluación de vulnerabilidades, Security Center genera la siguiente recomendación de seguridad:

**Debe habilitarse una solución de evaluación de vulnerabilidades en sus máquinas virtuales**

Use esta recomendación para implementar la solución de evaluación de vulnerabilidades en las máquinas virtuales de Azure y en las máquinas híbridas habilitadas para Azure Arc.

Implemente la solución de evaluación de vulnerabilidades que mejor se adapte a sus necesidades y presupuesto:

- **Solución de evaluación de vulnerabilidades integrada (con tecnología de Qualys)** : Azure Defender incluye el examen de vulnerabilidades de las máquinas sin costo adicional. No se necesita ninguna licencia ni cuenta de Qualys, ya que todo se administra sin problemas en Security Center. En esta página se proporcionan detalles de este detector e instrucciones para implementarlo.

    > [!TIP]
    > La solución de evaluación de vulnerabilidades integrada de admite tanto máquinas virtuales de Azure como máquinas híbridas. Para implementar el analizador de evaluación de vulnerabilidades en máquinas locales y en varias nubes, conéctelas primero a Azure con Azure Arc, tal como se describe en [Conexión de máquinas que no son de Azure a Security Center](quickstart-onboard-machines.md).
    >
    > La solución de evaluación de vulnerabilidades integrada en Security Center funciona perfectamente con Azure Arc. Cuando haya implementado el Azure Arc,las máquinas aparecerán en Security Center y no se requiere ningún agente de Log Analytics.

- **Soluciones Traiga su propia licencia (BYOL)** : Security Center admite la integración de herramientas de otros proveedores, pero deberá controlar los costos de las licencias, la implementación y la configuración. Al implementar su herramienta con Security Center, obtendrá información sobre a qué máquinas virtuales de Azure les falta la herramienta. También podrá ver los resultados en Security Center. Si prefiere usar la licencia de Qualys o Rapid7 privada de la organización en lugar de la licencia de Qualys incluida en Azure Defender, consulte [Implementación de una solución de BYOL](deploy-vulnerability-assessment-byol-vm.md).


## <a name="availability"></a>Disponibilidad

|Aspecto|Detalles|
|----|:----|
|Estado de la versión:|Disponible con carácter general|
|Tipos de máquinas (escenarios híbridos):|![Sí](./media/icons/yes-icon.png) Azure Virtual Machines<br>![Sí](./media/icons/yes-icon.png) Máquinas habilitadas para Azure Arc (versión preliminar)|
|Precios:|Requiere [Azure Defender para servidores](defender-for-servers-introduction.md).|
|Roles y permisos necesarios:|**El propietario del recurso** puede implementar el analizador.<br>El **Lector de seguridad** puede ver los resultados.|
|Nubes:|![Sí](./media/icons/yes-icon.png) Nubes comerciales<br>![No](./media/icons/no-icon.png) Nacionales o soberanas (US Gov, China Gov, otros gobiernos)|
|||

## <a name="overview-of-the-integrated-vulnerability-scanner"></a>Información general del detector de vulnerabilidades integrado

El detector de vulnerabilidades incluido con Azure Security Center cuenta con la tecnología de Qualys. El detector de Qualys es una de las herramientas líderes para identificar en tiempo real las vulnerabilidades. Solo está disponible con [Azure Defender para servidores](defender-for-servers-introduction.md). No se necesita ninguna licencia ni cuenta de Qualys, ya que todo se administra sin problemas en Security Center.

### <a name="how-the-integrated-vulnerability-scanner-works"></a>Funcionamiento del detector de vulnerabilidades integrado

La extensión de detector de vulnerabilidades funciona de la siguiente manera:

1. **Implementación** : Azure Security Center supervisa las máquinas y proporciona recomendaciones para implementar la extensión de Qualys en las máquinas seleccionadas.

1. **Recopilación de información** : la extensión recopila artefactos y los envía para su análisis en el servicio en la nube de Qualys de la región definida.

1. **Análisis** : el servicio en la nube de Qualys realiza la evaluación de vulnerabilidades y envía los resultados a Security Center. 

    > [!IMPORTANT]
    > Para garantizar la privacidad, la confidencialidad y la seguridad de nuestros clientes, no compartimos la información de los clientes con Qualys. [Obtenga más información sobre los estándares de privacidad integrados en Azure](https://www.microsoft.com/trust-center/privacy).

1. **Informe** : los resultados están disponibles en Security Center.

[![Diagrama de flujo del proceso para el detector de vulnerabilidades integrado de Azure Security Center](media/built-in-vulnerability-assessment/va-vm-flow-diagram.png)](media/built-in-vulnerability-assessment/va-vm-flow-diagram.png#lightbox)


## <a name="deploy-the-integrated-scanner-to-your-azure-and-hybrid-machines"></a>Implementación del analizador integrado en las máquinas híbridas y de Azure

1. En [Azure Portal](https://azure.microsoft.com/features/azure-portal/), abra **Security Center**.

1. En el menú de Security Center, abra la página **Recomendaciones**.

1. Seleccione la recomendación **La solución de evaluación de vulnerabilidades debe estar habilitada en sus máquinas virtuales**.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png" alt-text="Agrupaciones de las máquinas en la página de recomendaciones" lightbox="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png":::

    > [!TIP]
    > La máquina "Server16-test" anterior es una máquina habilitada para Azure Arc. Para implementar el analizador de evaluación de vulnerabilidades en máquinas locales y en varias nubes, consulte [Conexión de máquinas que no son de Azure a Security Center](quickstart-onboard-machines.md).
    >
    > Security Center funciona perfectamente con Azure Arc. Cuando haya implementado el Azure Arc,las máquinas aparecerán en Security Center y no se requiere ningún agente de Log Analytics.

    Las máquinas aparecerán en uno o varios de los siguientes grupos:

    * **Recursos correctos** : Security Center ha detectado una solución de evaluación de vulnerabilidades que se ejecuta en estas máquinas.
    * **Recursos incorrectos** : la extensión del detector de vulnerabilidades se puede implementar en estas máquinas. 
    * **Recursos no aplicables** : no se puede implementar la extensión del detector de vulnerabilidades en estas máquinas. Es posible que la máquina esté en esta pestaña porque es una imagen de un clúster de AKS, forma parte de un conjunto de escalado de máquinas virtuales o no ejecuta uno de los sistemas operativos compatibles con el examen de vulnerabilidades integrado:

        | **Proveedor** | **SISTEMA OPERATIVO** | **Versiones compatibles** |
        |----|----|----|
        |Microsoft|Windows|All|
        |Red Hat|Enterprise Linux|5.4+, 6, 7.0-7.8, 8.0-8.1|
        |Red Hat|CentOS|5.4+, 6, 7.0-7.7, 8.0-8.1|
        |Red Hat|Fedora|22-31|
        |SUSE|Linux Enterprise Server (SLES)|11, 12, 15|
        |SUSE|OpenSUSE|12, 13, 15.0-15.2|
        |SUSE|Leap|42.1|
        |Oracle|Enterprise Linux|5.11, 6, 7.0-7.5|
        |Debian|Debian|7.x-10.x|
        |Ubuntu|Ubuntu|12.04 LTS, 14.04 LTS, 15.x, 16.04 LTS, 18.04 LTS, 19.10, 20.04 LTS|

1. En la lista de máquinas incorrectas, seleccione las que recibirán una solución de evaluación de vulnerabilidades y seleccione **Corregir**.

    >[!IMPORTANT]
    > En función de la configuración, esta lista puede aparecer de manera diferente. 
    >
    > - Si no tiene un detector de vulnerabilidades de terceros configurado, no se le ofrecerá la oportunidad de implementarlo.
    > - Si las máquinas seleccionadas no están protegidas con Azure Defender, la opción de examen de vulnerabilidades integrada de ASC no estará disponible.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-remediation-options.png" alt-text="Las opciones para el tipo de flujo de corrección que quiere elegir al responder a la recomendación de la página **La solución de evaluación de vulnerabilidades debe estar habilitada en sus máquinas virtuales**":::

1. Elija la opción recomendada, **Deploy ASC integrated vulnerability scanner** (Implementar el detector de vulnerabilidades integrado de ASC) y **Continuar**.

1. Se le pedirá una confirmación adicional. Seleccione **Corregir**.

    La extensión del escáner se instalará en todas las máquinas seleccionadas en unos minutos.
    
    El examen se iniciará automáticamente en cuanto se implemente correctamente la extensión. Luego, los exámenes se ejecutarán a intervalos de cuatro horas. Este intervalo no es configurable.

    >[!IMPORTANT]
    > Si se produce un error en la implementación en una o varias máquinas, asegúrese de que las máquinas de destino pueden comunicarse con el servicio en la nube de Qualys en las dos direcciones IP siguientes (a través del puerto 443, predeterminado para HTTPS):
    >
    >   - 64.39.104.113: centro de datos de Qualys en los EE. UU.
    >   - 154.59.121.74: centro de datos de Qualys en Europa
    >
    > Si la máquina se encuentra en una región europea de Azure, sus artefactos se procesarán en el centro de datos europeo de Qualys. Los artefactos para máquinas virtuales ubicadas en cualquier otro lugar se envían al centro de datos de EE. UU.


## <a name="automate-at-scale-deployments"></a>Automatización de implementaciones a escala

> [!NOTE]
> Todas las herramientas que se describen en esta sección están disponibles en el [Repositorio de la comunidad de GitHub de Security Center](https://github.com/Azure/Azure-Security-Center/blob/master/README.md). En él puede encontrar scripts, automatizaciones y otros recursos útiles que puede usar a lo largo de la implementación de ASC.
>
> Algunas de estas herramientas solo afectan a las nuevas máquinas conectadas después de habilitar la implementación a escala. Asimismo, otras también se implementan en los equipos existentes. Igualmente puede combinar varios enfoques.

Aquí tiene algunas de las formas para automatizar la implementación a escala del escáner integrado:

- **Azure Resource Manager** : este método está disponible en la **vista de recomendaciones lógicas** de Azure Portal. El script de corrección incluye la plantilla de ARM pertinente que puede usar para la automatización: :::image type="content" source="./media/deploy-vulnerability-assessment-vm/deploy-at-scale-remediation-logic.png" alt-text="El script de corrección incluye la plantilla de ARM pertinente que puede usar para la automatización" lightbox="./media/deploy-vulnerability-assessment-vm/deploy-at-scale-remediation-logic.png":::
- **Directiva DeployIfNotExists** : [es una directiva personalizada](https://github.com/Azure/Azure-Security-Center/tree/master/Remediation%20scripts/Enable%20the%20built-in%20vulnerability%20assessment%20solution%20on%20virtual%20machines%20(powered%20by%20Qualys)/Azure%20Policy) que se usa para garantizar que todos los equipos recién creados reciben el escáner. Seleccione **Implementar en Azure** y establezca los parámetros pertinentes. Puede asignar esta directiva en el nivel de grupos de recursos, suscripciones o grupos de administración.
- **Script de PowerShell** : use el script ```Update qualys-remediate-unhealthy-vms.ps1``` para implementar la extensión de todas las máquinas virtuales incorrectas. Para realizar instalaciones en nuevos recursos, automatice el script con [Azure Automation](../automation/automation-intro.md). El script busca todos los equipos incorrectos que haya detectado la recomendación y ejecuta una llamada a Azure Resource Manager.
- **Azure Logic Apps** : le permite compilar una aplicación lógica basada en la [aplicación de ejemplo](https://github.com/Azure/Azure-Security-Center/tree/master/Workflow%20automation/Install-VulnAssesmentAgent). Use las herramientas de [automatización del flujo de trabajo](workflow-automation.md) de Security Center para desencadenar la aplicación lógica y así implementar el escáner cada vez que deba generar la recomendación **A vulnerability assessment solution should be enabled on your virtual machines** (Una solución de evaluación de vulnerabilidades debe habilitarse en las máquinas virtuales) para un recurso.
- **API de REST** : para implementar la solución de evaluación de vulnerabilidades integrada mediante la API de REST de Security Center, realice una solicitud PUT en la siguiente dirección URL y agregue el id. de recurso pertinente: ```https://management.azure.com/<resourceId>/providers/Microsoft.Security/serverVulnerabilityAssessments/default?api-Version=2015-06-01-preview```.



## <a name="trigger-an-on-demand-scan"></a>Desencadenamiento de un examen a petición

Puede desencadenar un examen a petición desde la propia máquina, mediante scripts o GPO ejecutados de forma local o remota. Como alternativa, puede integrarlo en las herramientas de distribución de software al final de un trabajo de implementación de revisiones. 

Los siguientes comandos desencadenan un examen a petición:

- **Máquinas Windows** : ```REG ADD HKLM\SOFTWARE\Qualys\QualysAgent\ScanOnDemand\Vulnerability /v "ScanOnDemand" /t REG_DWORD /d "1" /f```
- **Máquinas Linux** : ```sudo /usr/local/qualys/cloud-agent/bin/cloudagentctl.sh action=demand type=vm```

## <a name="faq---integrated-vulnerability-scanner-powered-by-qualys"></a>P+F: Detector de vulnerabilidades integrado (con tecnología de Qualys)

### <a name="are-there-any-additional-charges-for-the-qualys-license"></a>¿Hay cargos adicionales por la licencia de Qualys?
No. El examen integrado es gratuito para todos los usuarios de Azure Defender. La recomendación implementa el detector con la información de configuración y licencias. No se requieren licencias adicionales. 

### <a name="what-prerequisites-and-permissions-are-required-to-install-the-qualys-extension"></a>¿Qué requisitos previos y permisos son necesarios para instalar la extensión de Qualys?
Necesitará permisos de escritura para cualquier máquina en la que quiera implementar la extensión.

La extensión de evaluación de vulnerabilidades de Azure Security Center (con tecnología de Qualys), al igual que otras extensiones, se ejecuta sobre el agente de máquina virtual de Azure. Por lo tanto, se ejecuta como host local en Windows y raíz en Linux.

Durante la instalación, Security Center comprueba que la máquina puede comunicarse con los dos centros de datos de Qualys siguientes (a través del puerto 443, el valor predeterminado para HTTPS):

- 64.39.104.113: centro de datos de Qualys en los EE. UU.
- 154.59.121.74: centro de datos de Qualys en Europa

La extensión no acepta actualmente ningún detalle de configuración de proxy.

### <a name="can-i-remove-the-security-center-qualys-extension"></a>¿Se puede quitar la extensión de Qualys de Security Center? 
Si quiere quitar la extensión de una máquina, puede hacerlo manualmente o con cualquiera de las herramientas de programación. 

Necesitará los siguientes detalles:

* En Linux, la extensión se denomina "LinuxAgent.AzureSecurityCenter" y el nombre del editor es "Qualys".
* En Windows, la extensión se denomina "WindowsAgent.AzureSecurityCenter" y el nombre del proveedor es "Qualys".

### <a name="how-does-the-extension-get-updated"></a>¿Cómo se actualiza la extensión?
Al igual que el propio agente de Azure Security Center y el resto de extensiones de Azure, las actualizaciones secundarias del detector Qualys se podrían realizar automáticamente en segundo plano. Todos los agentes y extensiones se prueban exhaustivamente antes de implementarse automáticamente.

### <a name="why-does-my-machine-show-as-not-applicable-in-the-recommendation"></a>¿Por qué muestra mi máquina el mensaje "no aplicable" en la recomendación?
La página de detalles de la recomendación agrupa las máquinas en las siguientes listas: **correcta** , **incorrecta** y **no aplicable**.

Si tiene máquinas en el grupo de recursos **no aplicables** significa que Security Center no puede implementar la extensión del detector de vulnerabilidades en esas máquinas.

Es posible que la máquina esté en esta pestaña porque:

- No está protegida por Azure Defender: como se explicó anteriormente, el examen de vulnerabilidades incluido en Azure Security Center solo está disponible para las máquinas protegidas por [Azure Defender para servidores](defender-for-servers-introduction.md).

- Se trata de una imagen en un clúster de AKS o parte de un conjunto de escalado de máquinas virtuales. Esta extensión no es compatible con las VM que son recursos de PaaS.

- No se ejecuta uno de los sistemas operativos compatibles:

    | **Proveedor** | **SISTEMA OPERATIVO** | **Versiones compatibles** |
    |----|----|----|
    |Microsoft|Windows|All|
    |Red Hat|Enterprise Linux|5.4+, 6, 7.0-7.8, 8.0-8.1|
    |Red Hat|CentOS|5.4+, 6, 7.0-7.7, 8.0-8.1|
    |Red Hat|Fedora|22-31|
    |SUSE|Linux Enterprise Server (SLES)|11, 12, 15|
    |SUSE|OpenSUSE|12, 13, 15.0-15.2|
    |SUSE|Leap|42.1|
    |Oracle|Enterprise Linux|5.11, 6, 7.0-7.5|
    |Debian|Debian|7.x-10.x|
    |Ubuntu|Ubuntu|12.04 LTS, 14.04 LTS, 15.x, 16.04 LTS, 18.04 LTS, 19.10, 20.04 LTS|
    ||||

### <a name="what-is-scanned-by-the-built-in-vulnerability-scanner"></a>¿Qué examina el detector de vulnerabilidades integrado?
El analizador se ejecuta en la máquina para buscar vulnerabilidades de la propia máquina. Desde la máquina no puede examinar la red.

### <a name="does-the-scanner-integrate-with-my-existing-qualys-console"></a>¿Se integra el detector con mi consola de Qualys ya existente?
La extensión de Security Center es una herramienta independiente del detector Qualys existente. Las restricciones de licencia significan que solo se pueden usar en Azure Security Center.

### <a name="microsoft-defender-advanced-threat-protection-also-includes-threat--vulnerability-management-tvm-how-is-the-security-center-vulnerability-assessment-extension-different"></a>La Protección contra amenazas avanzada de Microsoft Defender también incluye administración de amenazas y vulnerabilidades (TVM). ¿En qué se diferencia la extensión de evaluación de vulnerabilidades de Security Center?
Microsoft se encuentra en proceso de desarrollo de un servicio de administración de vulnerabilidades de primera clase con la solución de administración de amenazas y vulnerabilidades de ATP de Microsoft Defender integrada en Windows.

En la actualidad, la extensión de valoración de vulnerabilidades de Azure Security Center cuenta con tecnología de Qualys. La extensión de Qualys garantiza la compatibilidad con las máquinas Windows y Linux. La extensión también se beneficia de los conocimientos propios de Qualys de las vulnerabilidades que todavía no tienen CVE.

### <a name="how-quickly-will-the-scanner-identify-newly-disclosed-critical-vulnerabilities"></a>¿Con qué rapidez identificará el detector las vulnerabilidades críticas recién reveladas?
48 horas después de la divulgación de una vulnerabilidad crítica, Qualys incorpora la información en su proceso y puede identificar las máquinas afectadas.



## <a name="next-steps"></a>Pasos siguientes

> [!div class="nextstepaction"]
> [Corrección de los resultados de las soluciones de evaluación de vulnerabilidades](remediate-vulnerability-findings-vm.md)


Security Center también ofrece análisis de vulnerabilidades para:

- SQL Database: consulte [Exploración de los informes de evaluación de vulnerabilidades en el panel de evaluación de vulnerabilidades](defender-for-sql-usage.md#explore-vulnerability-assessment-reports).
- Imágenes de Azure Container Registry: consulte [Uso de Azure Defender para registros de contenedor para examinar las imágenes en busca de vulnerabilidades](defender-for-container-registries-usage.md)